# gen-music-for-airports
gen-music-for-airports

## About

このプロジェクトは、ブライアン・イーノの「Music for Airports 2/1」をWeb Audio API（Tone.js）を使用して再現したものです。以下、主要な構成要素と機能について詳しく説明します。

## 📁 プロジェクト構成
- **index.html** - アプリケーション全体を含む単一のHTMLファイル
- **README.md** - プロジェクトの概要とGitHub ActionsとClaude Codeの統合についての説明
- **LICENSE** - MITライセンスファイル

## 🎼 Brian Enoの作曲技法と実装

### 1. **ジェネレーティブ音楽（Generative Music）の原理**

Brian Enoは「Music for Airports」において、**ジェネレーティブ音楽**という革新的な作曲技法を確立しました。これは従来の線形的な楽曲構成とは異なり、以下の特徴を持ちます：

#### **非同期ループシステム**
```javascript
const loopData = [
    { note: "G#4", length: 17.8, volume: -18, synthType: 'fatsine', ... },
    { note: "C4",  length: 20.1, volume: -19, synthType: 'fatsine', ... },
    // ... 他5つのループ
];
```

- **異なる長さのループ**: 16.2秒〜31.8秒という素数的な関係にある長さを使用
- **位相のずれ**: 各ループが独立して動作することで、常に新しい音の組み合わせが生成される
- **無限の変化**: ループの最小公倍数が極めて大きいため、パターンが完全に繰り返されるまでに数時間かかる

### 2. **アンビエント音楽の美学**

Enoが提唱した「アンビエント音楽」の概念を実装：

#### **「無視できる音楽」（Ignorable as it is Interesting）**
- **控えめな音量設定**: -17dB〜-20dBという低い音量レベル
- **緩やかなエンベロープ**: 長いアタックとリリースタイムで音の輪郭をぼかす
```javascript
envelope: {
    attack: 2.5,
    decay: 1.0,
    sustain: 0.7,
    release: 8.0
}
```

#### **空間性の創出**
```javascript
globalReverb = new Tone.Reverb({
    decay: 15,  // 15秒の長大なディケイタイム
    wet: parseFloat(reverbWetSlider.value),
    preDelay: 0.05
}).connect(masterVolume);
```
- **大聖堂のような残響**: 15秒という極めて長いリバーブで空港の広大な空間を表現
- **音の融合**: 個々の音が空間で混ざり合い、新たな倍音構造を生成

### 3. **偶然性と制御のバランス**

#### **制御された偶然性**
- **LFOによる微細な変動**: アナログシンセサイザーの不安定性を再現
```javascript
const pitchLFO = new Tone.LFO({
    frequency: 0.02,  // 非常に遅い変調
    min: -3,
    max: 3,
    amplitude: 1
}).start();
```

#### **倍音構造の豊かさ**
- **4つの倍音**: 各音に深みと複雑性を与える
- **微妙なデチューン**: spread: 15による音の厚み

### 4. **「家具の音楽」（Furniture Music）の現代的解釈**

Erik Satieの「家具の音楽」概念を発展させた実装：

- **環境との調和**: バイオフィードバック機能による聴取者の状態への適応
- **非侵襲的な存在**: 注意を強要しない音楽設計
- **継続的な変化**: 退屈を防ぐ微細な変化の連続

## 🎵 技術的な実装

### 1. **音声生成システム** (`index.html:367-506`)
7つの異なる音声ループを使用して、非同期のアンビエント音楽を生成します：

各ループは以下の要素を持ちます：
- **音程（note）**: G#4、C4、C#4、F4、D#4、G#3、F3
- **ループ長（length）**: 16.2秒〜31.8秒の異なる長さ
- **音量（volume）**: -17dB〜-20dB
- **音色設定**: エンベロープ（Attack/Decay/Sustain/Release）と倍音構成

### 2. **バイオフィードバック機能** (`index.html:509-622`)
心拍数（HR）と心拍変動（HRV）のデータを使用して、音楽パラメータをリアルタイムで調整：

```javascript
function applyBioFeedback(hr, hrv) {
    const tempoScale = clamp(hr/60, 0.6, 1.5);  // テンポの調整
    const relax = 1/(1+Math.exp(-(hrv-30)/15));  // リラックス度の計算
    // ループ長、音量、LFO、エンベロープなどを動的に調整
}
```

### 3. **シンセサイザー設定** (`index.html:667-729`)
Tone.jsを使用して各ループのシンセサイザーを作成：

```javascript
const synth = new Tone.Synth({
    oscillator: {
        type: data.synthType,
        count: 4,
        spread: 15
    },
    envelope: {
        attack: data.envelope.attack,
        decay: data.envelope.decay,
        sustain: data.envelope.sustain,
        release: data.envelope.release
    },
    volume: data.volume
}).connect(globalReverb);
```

### 4. **空間音響処理** (`index.html:671-677`)
長いディケイタイムのリバーブを使用して空間的な響きを作成。

### 5. **LFO（低周波発振器）** (`index.html:701-710`)
アナログの揺らぎをエミュレートするため、各シンセにLFOを適用。

### 6. **ビジュアルエフェクト** (`index.html:1066-1154`)
p5.jsを使用した3Dパーティクルアニメーション：
- 5000個のパーティクルが音量に応じて動的に変化
- 3D空間での回転と移動
- 音声レベルに基づいて半径が変化

## 🎛️ ユーザーインターフェース

### コントロールパネル
1. **バイオフィードバック**
   - HR（心拍数）: 40-120 bpm
   - HRV（心拍変動）: 10-120 ms RMSSD

2. **音響コントロール**
   - マスター音量
   - リバーブ量

3. **各シンセサイザーの詳細設定**
   - ループ長の調整
   - 音量コントロール
   - 倍音構成（4つの倍音）
   - エンベロープ（ADSR）
   - LFO設定（周波数、最小値、最大値）

## 🔄 ループ管理システム
各ループは独立して動作し、プログレスバーでリアルタイムの再生位置を表示。ユーザーはプログレスバーをクリックして再生位置を変更可能。

## 📱 レスポンシブデザイン
モバイル対応のCSSメディアクエリを使用（`index.html:126-143`）

## 主な特徴
1. **非同期ループ**: 7つのループが異なる長さで独立して動作
2. **リアルタイム制御**: 再生中でもパラメータを調整可能
3. **視覚的フィードバック**: プログレスバーとパーティクルアニメーション
4. **バイオフィードバック統合**: 生体データに基づく音楽の自動調整

## 🎨 Brian Enoの遺産と現代的発展

このプロジェクトは、Brian Enoが1978年に提示した革新的なアイデアを、現代のWeb技術で実現したものです。オリジナルのテープループシステムをデジタルで再現しながら、以下の現代的な要素を追加しています：

- **インタラクティブ性**: ユーザーが各パラメータをリアルタイムで調整可能
- **視覚化**: 音楽の状態を3Dビジュアルで表現
- **生体連動**: バイオフィードバックによる個人化された体験
- **アクセシビリティ**: ブラウザだけで体験できる手軽さ

このプロジェクトは、実験的な電子音楽とWeb Audio技術を組み合わせた、インタラクティブなアンビエント音楽生成システムです。

### License

MIT license